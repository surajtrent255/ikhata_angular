<main id="main" class="main overflow-auto">
  <div class="pagetitle">
    <h1>Bank Deposit</h1>
    <nav>
      <ol class="breadcrumb">
        <li class="breadcrumb-item">
          <a routerLink="/home/dashboard">Home</a>
        </li>
        <li class="breadcrumb-item active">Bank</li>
        <li class="breadcrumb-item active">Deposit</li>
      </ol>
    </nav>
  </div>

  <section class="section">
    <div class="row">
      <div class="col-lg-12">
        <div class="card">
          <div class="card-body">
            <div class="mt-2 mb-2">
              <h5 class="card-title">Deposit List Table</h5>
              <hr class="border-2 mb-2" />
            </div>

            <div class="card">
              <div class="card-body">
                <div class="d-flex justify-content-between">
                  <div class="col-4 mt-2">
                    <div class="input-group rounded">
                      <input
                        type="search"
                        class="form-control rounded"
                        placeholder="Search"
                        name="searchInput"
                        aria-label="Search"
                        aria-describedby="search-addon"
                      />
                      <span class="input-group-text border-0" id="search-addon">
                        <i class="fas fa-search"></i>
                      </span>
                      <a
                        style="cursor: pointer; margin-left: 6px"
                        class="pe-auto mt-1 ml-2 text-decoration-underline"
                      >
                        clear Search</a
                      >
                    </div>
                  </div>

                  <div class="col-4 mt-2">
                    <div>
                      <a
                        *ngIf="isAccountant || isMaster"
                        style="cursor: pointer"
                        (click)="onCreate()"
                      >
                        <img
                          src="../../../../../../assets/img/createProduct.png"
                        />
                        <span> Create Bank Deposit</span>
                      </a>
                    </div>
                  </div>

                  <nav style="margin-top: 2px" aria-label="Page navigation ">
                    <ul class="pagination">
                      <li class="page-item">
                        <a class="page-link pe-auto" aria-label="Previous">
                          <span aria-hidden="true">&laquo;</span>
                        </a>
                      </li>
                      <li class="page-item">
                        <a class="page-link">1</a>
                      </li>
                      <li class="page-item">
                        <a class="page-link pe-auto" aria-label="Next">
                          <span aria-hidden="true">&raquo;</span>
                        </a>
                      </li>
                    </ul>
                  </nav>
                </div>

                <table class="table table-bordered table-striped">
                  <thead>
                    <tr>
                      <th scope="col">Bank Id</th>
                      <th scope="col">Deposite Amount</th>
                      <th scope="col">Deposite Type</th>
                      <th scope="col">Cheque Number</th>
                      <th>Actions</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr *ngFor="let deposite of deposites">
                      <td>
                        <span *ngFor="let b of bankList">
                          <span *ngIf="b.id === deposite.bankId">
                            {{ b.name }}
                          </span>
                        </span>
                      </td>
                      <td>{{ deposite.depositAmount }}</td>
                      <td>
                        <span *ngFor="let d of depositTypes">
                          <span
                            *ngIf="checkDepositType(d.id, deposite.depositType)"
                            >{{ d.name }}</span
                          >
                        </span>
                      </td>
                      <td>{{ deposite.chequeNumber }}</td>
                      <td class="last-child">
                        <a
                          id="editDeposit"
                          (click)="editBankDeposit(deposite.depositId)"
                          class="createNewTableRecord"
                        >
                          <img
                            src="../../../assets/resources/images/editRow.png" title="Edit"
                          />
                        </a>
                        <a
                          (click)="
                            deleteDeposite(
                              deposite.branchId,
                              deposite.depositId
                            )
                          "
                          class="deleteRowLink deleteGroupCombo"
                        >
                          <img
                            src="../../../assets/resources/images/deleteRow.png" title="Delete"
                          />
                        </a>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>
</main>

<a
  type="button"
  id="bankDepositPopup"
  data-bs-toggle="modal"
  data-bs-target="#bankDeposit"
  [hidden]="true"
></a>
<ngx-smart-modal
  identifier="createBankDeposit"
  id="createBankDepositPopup"
  [closable]="false"
  [dismissable]="false"
  (mousedown)="CommonService.handleMouseDown($event)"
  (mousemove)="CommonService.elementDrag($event)"
  (mouseup)="CommonService.clear()"
>
  <div class="custom-modal-header">
    <h5 class="custom-modal-title">Bank Deposit</h5>
    <button
      #closeButton
      type="button"
      class="btn-close"
      data-bs-dismiss="modal"
      (click)="cancel(createDepositeForm)"
      aria-label="Close"
    ></button>
  </div>

  <div>
    <form
      #createDepositeForm="ngForm"
      name="createDepositeForm"
      id="createDepositeForm"
      (ngSubmit)="creatdepostie(createDepositeForm)"
      (keydown.enter)="onEnter($event)"
    >
      <div class="chooseColoumnsWrapper">
        <div class="fieldDiv popUpFormSectionWrapper">
          <table class="table table-stripped" cellpadding="0" cellspacing="0">
            <tr>
              <td class="col-md-3 pt-2">
                Bank Name:<span class="mandatorySign">*</span>
              </td>
              <td class="col-md-6">
                <select
                  class="form-control form-select"
                  name="bankId"
                  id="bankId"
                  name="bankId"
                  #bankId="ngModel"
                  [(ngModel)]="objdeposite.bankId"
                  [class.is-invalid]="bankId.invalid && bankId.touched"
                >
                  <option value="" selected disabled>select Bank Name</option>
                  <option *ngFor="let option of banks" [value]="option.bankId">
                    <span *ngFor="let bl of bankList">
                      <b *ngIf="bl.id === option.bankTypeId">{{ bl.name }}</b></span
                    >
                  </option>
                </select>
              </td>
              <td class="col-md-3">
                <small
                  class="text-danger"
                  [class.d-none]="bankId.valid || bankId.untouched"
                  >invalid name</small
                >
              </td>
            </tr>
            <tr>
              <td class="col-md-3 pt-2">
                Deposit Amount:<span class="mandatorySign">*</span>
              </td>
              <td class="col-md-6">
                <input
                  type="number"
                  name="depositAmount"
                  [(ngModel)]="objdeposite.depositAmount"
                  required
                  #depositAmount="ngModel"
                  [class.is-invalid]="
                    depositAmount.invalid && depositAmount.touched
                  "
                  class="form-control"
                  id="depositAmount"
                />
              </td>
              <td class="col-md-3">
                <small
                  class="text-danger"
                  [class.d-none]="
                    depositAmount.valid || depositAmount.untouched
                  "
                  >invalid anount</small
                >
              </td>
            </tr>
            <tr>
              <td class="col-md-3 pt-2">
                Deposit Type:<span class="mandatorySign">*</span>
              </td>
              <td class="col-md-6">
                <select
                  name="withdrawType"
                  id="withdrawType"
                  class="form-control form-select"
                  [(ngModel)]="objdeposite.depositType"
                  required
                >
                  <option value="{{ t.id }}" *ngFor="let t of depositTypes">
                    {{ t.name }}
                  </option>
                </select>
              </td>

              <!-- <td class="col-md-6">
                      <input
                        name="depositType"
                        [(ngModel)]="objdeposite.depositType"
                        required
                        #depositType="ngModel"
                        [class.is-invalid]="
                          depositType.invalid && depositType.touched
                        "
                        class="form-control"
                        id="depositType"
                      />
                    </td>
                    <td class="col-md-3">
                      <small
                        class="text-danger"
                        [class.d-none]="
                          depositType.valid || depositType.untouched
                        "
                        >invalid depositType</small
                      >
                    </td> -->
            </tr>
            <tr>
              <td class="col-md-3 pt-2">Cheque Number:</td>
              <td class="col-md-6">
                <input
                  name="chequeNumber"
                  title="check your stock "
                  [(ngModel)]="objdeposite.chequeNumber"
                  #chequeNumber="ngModel"
                  class="form-control"
                  id="chequeNumber"
                />
              </td>
            </tr>
            <tr>
              <td class="col-md-3 pt-2">
                Deposited By: <span class="mandatorySign">*</span>
              </td>
              <td class="col-md-6">
                <input
                  name="depositedBy"
                  [(ngModel)]="objdeposite.depositedBy"
                  #depositedBy="ngModel"
                  (keydown.enter)="fetchDepositer(depositedBy.value)"
                  class="form-control"
                  required
                  id="depositedBy"
                  placeholder="vat or pan"
                  style="display: inline"
                />
              </td>
              <td style="padding-left: 2px">
                <span
                  (click)="displayAddCustomerPopup()"
                  data-toggle="tooltip"
                  data-placement="top"
                  title="Create New Customer"
                  style="display: inline"
                >
                  <i
                    style="color: rebeccapurple"
                    class="fa-solid fa-user-plus"
                  ></i>
                </span>
                <span class="ml-1" id="depositorName"></span>
              </td>
            </tr>
            <tr class="mt-4">
              <td class="col-md-3 pt-2">Date:</td>
              <td class="col-md-6">
                <div class="p-0">
                  <input
                    type="text"
                    class="form-control"
                    id="nepali-datepicker"
                    placeholder="Select  Date"
                    style="width: 100%; height: 100%"
                    class="inputText"
                  />

                  <br />
                  <span style="margin-top: 2px"></span>

                  <!-- <span style="font-size: small">
                    ({{ AdDateForDisplayOnly }})</span
                  > -->
                  <input
                    disabled
                    type="text"
                    id="AdDate"
                    hidden
                    style="
                      height: 25px;
                      width: 150px;
                      background-color: white;
                      font-size: small;
                    "
                  />
                </div>
              </td>
            </tr>
          </table>
        </div>
      </div>

      <div class="custom-modal-footer d-flex justify-content-end">
        <input
          type="submit"
          class="btn btn-success border-rad"
          id="submitCategoryPrd"
          value="Add Deposit"
          [disabled]="createDepositeForm.form.invalid"
        />
        <button
          type="button"
          class="btn btn-secondary"
          (click)="cancel(createDepositeForm)"
          data-bs-dismiss="modal"
        >
          Close
        </button>
      </div>
    </form>
  </div>
</ngx-smart-modal>

<ngx-smart-modal identifier="selectDepositorPopup" [closable]="false" [dismissable]="false">

<app-select-customer
  *ngIf="selectDepositorEnable"
  [customerMetaData]="depositorMetaData"
  (compIdEvent)="setDepositorInfo($event)"
  (destroySelectCompEmitter)="destroySelectDepositorComponent($event)"
  [title]="'Depositor'"
>
</app-select-customer>
</ngx-smart-modal>


<app-create-customer
  *ngIf="createCustomerEnable"
  (emitToReset)="createCustomerToggle = !createCustomerToggle"
  (customerAddedSuccessMsg)="customerAddedSuccessfully($event)"
  (destroyCreateCustComp)="destroyCreateCustomerComp($event)"
  [title]="'Customer'"
></app-create-customer>
